const fs=require('fs'); const path=require('path'); const file=path.join(__dirname,'..','assets','js','admin.js'); const s=fs.readFileSync(file,'utf8').split(/\r?\n/); let lo=0, hi=s.length; while(lo<hi){ const mid=Math.ceil((lo+hi)/2); const prefix=s.slice(0,mid).join('\n'); try{ new Function(prefix); lo=mid; }catch(e){ hi=mid-1; } if (hi-lo<=1) break; } console.log('approx max parseable prefix lines', lo); console.log('checking around', lo-5, lo+5); console.log(s.slice(Math.max(0,lo-10),Math.min(s.length,lo+10)).map((ln,idx)=>((Math.max(0,lo-10)+idx)+1)+': '+ln).join('\n'));